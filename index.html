<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Stay Awake</title>
  <style>
    body {
      font-family: system-ui, sans-serif;
      background: #0f141a;
      color: #e9eef5;
      display: grid;
      place-items: center;
      height: 100vh;
      margin: 0;
    }
    .card {
      background: #171f2a;
      padding: 24px;
      border-radius: 16px;
      text-align: center;
      max-width: 420px;
    }
    button {
      margin-top: 16px;
      padding: 12px 20px;
      font-size: 16px;
      font-weight: 600;
      border: none;
      border-radius: 10px;
      cursor: pointer;
      background: #00c853;
      color: #0c1a10;
      transition: background 0.2s;
    }
    button.stop {
      background: #ff5252;
      color: #fff;
    }
    .status {
      margin-top: 12px;
      font-size: 14px;
      color: #a9b4c0;
    }
  </style>
</head>
<body>
  <div class="card">
    <h1>ðŸŸ¢ Stay Awake</h1>
    <button id="btnToggle">Start</button>
    <div class="status" id="statusText">Idle â€” click Start to keep your PC awake.</div>
  </div>

  <!-- Silent audio loop -->
  <audio id="bgAudio" loop muted playsinline preload="auto">
    <source src="data:audio/wav;base64,UklGRiQAAABXQVZFZm10IBAAAAABAAEAESsAACJWAAACABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA=" type="audio/wav" />
  </audio>

  <script>
    let wakeLock = null;
    let running = false;

    const btn = document.getElementById('btnToggle');
    const statusText = document.getElementById('statusText');
    const bgAudio = document.getElementById('bgAudio');

    function logStatus(msg) {
      console.log(msg);
      statusText.textContent = msg;
    }

    async function requestWakeLock() {
      if (!('wakeLock' in navigator)) {
        logStatus('Wake Lock API not supported in this browser.');
        return null;
      }
      try {
        const wl = await navigator.wakeLock.request('screen');
        wl.addEventListener('release', () => {
          logStatus('Wake lock released by system.');
          running = false;
          btn.textContent = 'Start';
          btn.classList.remove('stop');
        });
        logStatus('Active â€” keeping screen on and playing silent media.');
        return wl;
      } catch (err) {
        logStatus('Wake lock error: ' + err.message);
        return null;
      }
    }

    async function start() {
      running = true;
      btn.textContent = 'Stop';
      btn.classList.add('stop');
      wakeLock = await requestWakeLock();
      try {
        await bgAudio.play();
      } catch (err) {
        logStatus('Media play blocked: ' + err.message);
      }
    }

    async function stop() {
      running = false;
      btn.textContent = 'Start';
      btn.classList.remove('stop');
      if (wakeLock) {
        try { await wakeLock.release(); } catch {}
        wakeLock = null;
      }
      bgAudio.pause();
      bgAudio.currentTime = 0;
      logStatus('Idle â€” click Start to keep your PC awake.');
    }

    btn.addEventListener('click', () => {
      if (running) {
        stop();
      } else {
        start();
      }
    });
  </script>
</body>
</html>
